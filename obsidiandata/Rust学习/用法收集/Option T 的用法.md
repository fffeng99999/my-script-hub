
---

## 1ï¸âƒ£ å®šä¹‰

`Option<T>` æ˜¯ Rust æ ‡å‡†åº“å®šä¹‰çš„ä¸€ä¸ªæšä¸¾ï¼š

```rust
pub enum Option<T> {
    None,
    Some(T),
}
```

- **`Some(T)`**ï¼šæœ‰å€¼ï¼Œå­˜äº†ä¸€ä¸ª `T`
    
- **`None`**ï¼šæ²¡æœ‰å€¼
    
- **`T`** å¯ä»¥æ˜¯ä»»ä½•ç±»å‹
    

> è®¾è®¡ç›®çš„ï¼š**å®‰å…¨åœ°è¡¨ç¤ºå¯é€‰å€¼ï¼Œé¿å…ç©ºæŒ‡é’ˆï¼ˆnullï¼‰**ã€‚

---

## 2ï¸âƒ£ åŸºæœ¬ç”¨æ³•

```rust
fn main() {
    let a = Some(42);        // Option<i32>ï¼Œæœ‰å€¼
    let b: Option<i32> = None; // Option<i32>ï¼Œæ— å€¼

    println!("{:?} {:?}", a, b); // Some(42) None
}
```

---

## 3ï¸âƒ£ é…åˆæ¨¡å¼åŒ¹é…

Rust æä¾›äº† **ç©·å°½åŒ¹é…** æ¥å¤„ç† `Option`ï¼š

```rust
fn main() {
    let x = Some(10);

    match x {
        Some(v) => println!("æ‹¿åˆ°å€¼: {}", v),
        None => println!("æ²¡æœ‰å€¼"),
    }
}
```

å¸¸ç”¨çš„ç®€åŒ–æ–¹å¼æ˜¯ `if let`ï¼š

```rust
if let Some(v) = x {
    println!("å€¼æ˜¯ {}", v);
}
```

---

## 4ï¸âƒ£ å¸¸ç”¨æ–¹æ³•

`Option<T>` å®ç°äº†å¾ˆå¤šæ–¹æ³•ï¼Œæ”¯æŒ **å‡½æ•°å¼é“¾å¼æ“ä½œ**ã€‚

### ğŸ”¹1. æå–å€¼

- `unwrap()`ï¼šç›´æ¥æ‹¿å€¼ï¼Œ`None` ä¼š **panic**
    
- `unwrap_or(default)`ï¼š`None` æ—¶ç»™é»˜è®¤å€¼
    
- `unwrap_or_else(func)`ï¼š`None` æ—¶è°ƒç”¨å‡½æ•°ç”Ÿæˆé»˜è®¤å€¼
    
- `expect(msg)`ï¼š`None` æ—¶ panic å¹¶è¾“å‡ºè‡ªå®šä¹‰é”™è¯¯
    

```rust
let x = Some(5);
println!("{}", x.unwrap());           // 5
println!("{}", x.unwrap_or(0));       // 5

let y: Option<i32> = None;
println!("{}", y.unwrap_or(0));       // 0
```

---

### ğŸ”¹2. è½¬æ¢æ–¹æ³•

- `map`ï¼šå¯¹ `Some` é‡Œçš„å€¼åšæ˜ å°„
    
- `and_then` / `flat_map`ï¼šè¿”å›å¦ä¸€ä¸ª `Option`ï¼Œå¯é“¾å¼
    
- `filter`ï¼šæ¡ä»¶ä¸æ»¡è¶³å°±å˜ `None`
    

```rust
let x = Some(2);

let doubled = x.map(|v| v * 2);           // Some(4)
let even = x.filter(|v| v % 2 == 0);      // Some(2)
let odd = x.filter(|v| v % 2 != 0);       // None
```

---

### ğŸ”¹3. ç»„åˆæ–¹æ³•

- `or` / `or_else`ï¼š`None` æ—¶è¿”å›å¦ä¸€ä¸ª `Option`
    
- `and`ï¼šåªæœ‰å½“å‰å’Œå¦ä¸€ä¸ªéƒ½ `Some` æ‰è¿”å›åè€…
    
- `xor`ï¼šåªæœ‰ä¸€ä¸ªæ˜¯ `Some` æ‰è¿”å› `Some`
    

```rust
let a = Some(1);
let b = None;

println!("{:?}", a.or(b)); // Some(1)
println!("{:?}", b.or(a)); // Some(1)
```

---

### ğŸ”¹4. è½¬æ¢ä¸º `Result`

- `ok_or(err)`ï¼š`Some(v)` â†’ `Ok(v)`ï¼Œ`None` â†’ `Err(err)`
    
- `ok_or_else(func)`
    

```rust
let x: Option<i32> = None;
let r: Result<i32, &str> = x.ok_or("æ²¡æœ‰å€¼");
println!("{:?}", r); // Err("æ²¡æœ‰å€¼")
```

---

## 5ï¸âƒ£ å†…å­˜ä¸ä¼˜åŒ–

Rust çš„ `Option<T>` **æ²¡æœ‰é¢å¤–å¼€é”€**ï¼Œå› ä¸ºç¼–è¯‘å™¨åšäº†ä¼˜åŒ–ï¼š

- å¦‚æœ `T` ç±»å‹æœ¬èº«æœ‰æ— æ•ˆçŠ¶æ€ï¼ˆnicheï¼‰ï¼Œ`Option<T>` å¯ä»¥é›¶æˆæœ¬è¡¨ç¤º
    
- æ¯”å¦‚ `Option<&T>` åªå ä¸€ä¸ªæŒ‡é’ˆå¤§å°ï¼Œ`None` ç”¨ç©ºæŒ‡é’ˆè¡¨ç¤º
    

ä¸¾ä¾‹ï¼š

```rust
use std::mem::size_of;

fn main() {
    println!("{}", size_of::<Option<&i32>>()); // 8
    println!("{}", size_of::<Option<i32>>());  // 8
}
```

å³ä¾¿ `Option` æ˜¯æšä¸¾ï¼Œå®ƒçš„å†…å­˜å¸ƒå±€ä¾æ—§é«˜æ•ˆã€‚

---

## 6ï¸âƒ£ ä½¿ç”¨åœºæ™¯

1. **å‡½æ•°è¿”å›å¯èƒ½å¤±è´¥çš„å€¼**
    
    - æ²¡æ‰¾åˆ°å°±è¿”å› `None`ï¼Œæ‰¾åˆ°äº†è¿”å› `Some(v)`
        
2. **æ›¿ä»£ç©ºæŒ‡é’ˆ**
    
    - æ¯”å¦‚é“¾è¡¨å°¾å·´ `next` å­—æ®µç”¨ `Option<Box<Node>>`
        
3. **ç®€åŒ–æ¡ä»¶é€»è¾‘**
    
    - é…åˆ `map`ã€`filter`ã€`and_then`ï¼Œå¯ä»¥å†™å‡ºä¼˜é›…çš„é“¾å¼è°ƒç”¨
        

---

## 7ï¸âƒ£ å°ç»“

- `Option<T>` = `Some(T)` + `None`
    
- ç¼–è¯‘å™¨é›¶å¼€é”€ï¼Œå®‰å…¨æ›¿ä»£ `null`
    
- ä¸°å¯Œçš„æ–¹æ³•é“¾è®©é€»è¾‘æ›´ç®€æ´
    

---
## ç”¨æ³•æ€ç»´å¯¼å›¾
![[Rust `Option_T_` æ–¹æ³•ç»“æ„å›¾.png]]